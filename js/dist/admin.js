(()=>{var t={n:n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},d:(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};(()=>{"use strict";t.r(n),t.d(n,{extend:()=>c});const e=flarum.core.compat["common/extenders"];var o=t.n(e);function r(t,n){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},r(t,n)}function a(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n)}const i=flarum.core.compat["common/Model"];var l=t.n(i),s=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return(n=t.call.apply(t,[this].concat(o))||this).id=l().attribute("id"),n.mail_suffix=l().attribute("mail_suffix"),n.mail_host=l().attribute("mail_host"),n.mail_port=l().attribute("mail_port"),n.mail_username=l().attribute("mail_username"),n.mail_password=l().attribute("mail_password"),n.mail_encryption=l().attribute("mail_encryption"),n.mail_from=l().attribute("mail_from"),n}return a(n,t),n}(l());const c=[(new(o().Store)).add("multi-mailer",s)],u=flarum.core.compat["admin/app"];var d=t.n(u);const f=flarum.core.compat["common/extend"],p=flarum.core.compat["admin/components/MailPage"];var h=t.n(p);const _=flarum.core.compat["common/components/LinkButton"];var b=t.n(_);const v=flarum.core.compat["admin/components/ExtensionPage"];var y=t.n(v);const g=flarum.core.compat["common/components/Button"];var M=t.n(g);const x=flarum.core.compat["common/components/Modal"];var N=t.n(x);const w=flarum.core.compat["common/utils/Stream"];var B=t.n(w),P=function(t){function n(){return t.apply(this,arguments)||this}a(n,t);var e=n.prototype;return e.oninit=function(n){var e=this;t.prototype.oninit.call(this,n),this.mailer=this.attrs.mailer,this.fields=["mail_suffix","mail_host","mail_port","mail_username","mail_password","mail_encryption","mail_from"],this.values=this.fields.reduce((function(t,n){return t[n]=B()(e.mailer[n]()||""),t}),{})},e.className=function(){return"MailerModal Modal--large"},e.title=function(){return"Edit"},e.content=function(){var t=this;return m("div",{className:"Modal-body"},m("form",{onsubmit:this.onsubmit.bind(this)},this.fields.map((function(n){return m("div",{className:"Form-group"},m("label",{className:"MailerModal-label"},d().translator.trans("core.admin.email."+n+"_label")),m("input",{className:"FormControl",bidi:t.values[n],placeholder:n,disabled:"mail_suffix"===n&&1===t.mailer.id()}))})),m("div",{className:"Form-group"},M().component({type:"submit",className:"Button Button--primary Button--block MailerModal-save",loading:this.loading},d().translator.trans("core.admin.settings.submit_button")))))},e.onsubmit=function(t){var n=this;t.preventDefault(),this.loading=!0;var e=this.fields.reduce((function(t,e){return t[e]=n.values[e](),t}),{});this.mailer.save(e).then((function(){n.loading=!1,m.redraw(),n.hide()}))},n}(N()),S=function(t){function n(){return t.apply(this,arguments)||this}a(n,t);var e=n.prototype;return e.oninit=function(n){var e=this;t.prototype.oninit.call(this,n),this.loading=!0,this.records=[],d().store.find("multi-mailer").then((function(t){e.records=t,e.loading=!1,m.redraw()}))},e.content=function(){var t=this;return m("div",{className:"container MultiMailer-container"},m("table",{className:"MailerSettingsPage-table"},m("thead",null,m("tr",null,m("th",null,"Mail Suffix"),m("th",null,"Mail Host"),m("th",null,"Mail Port"),m("th",null,"Mail Username"),m("th",null,"Action"))),m("tbody",null,this.records.map((function(n){return m("tr",null,m("td",null,n.mail_suffix()),m("td",null,n.mail_host()),m("td",null,n.mail_port()),m("td",null,n.mail_username()),m("td",null,m(M(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){d().modal.show(P,{mailer:n})}}),m(M(),{className:"Button Button--icon",icon:"fas fa-trash",disabled:1===t.records.length||t.loading||1===n.id(),onclick:function(){n.delete().then((function(){t.records=t.records.filter((function(t){return t!==n})),m.redraw()}))}})))})),m("tr",null,m("td",{colspan:"4"},m(M(),{className:"Button Button--block",onclick:function(){d().store.createRecord("multi-mailer").save({mail_suffix:"new.com",mail_port:465,mail_encryption:"ssl"}).then((function(n){t.records.push(n),d().modal.show(P,{mailer:n})}))}},m("i",{className:"fas fa-plus"})," Add"))))),m(b(),{href:d().route("mail")},"Select mail driver and test"))},n}(y());d().initializers.add("foskym/flarum-multi-mailer",(function(){d().extensionData.for("foskym-multi-mailer").registerPage(S),(0,f.override)(h().prototype,"content",(function(t){var n=t();return"multi-smtp"!==this.setting("mail_driver")()||(n.children=n.children.concat([m(b(),{className:"Button",href:d().route("extension",{id:"foskym-multi-mailer"})},"Settings for Multi Mailer")])),n}))}))})(),module.exports=n})();
//# sourceMappingURL=admin.js.map
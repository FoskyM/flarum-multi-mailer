(()=>{var t={n:n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return t.d(o,{a:o}),o},d:(n,o)=>{for(var e in o)t.o(o,e)&&!t.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:o[e]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};(()=>{"use strict";t.r(n),t.d(n,{extend:()=>u});const o=flarum.core.compat["common/extenders"];var e=t.n(o);function a(t,n){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},a(t,n)}function i(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,a(t,n)}const r=flarum.core.compat["common/Model"];var l=t.n(r),s=function(t){function n(){for(var n,o=arguments.length,e=new Array(o),a=0;a<o;a++)e[a]=arguments[a];return(n=t.call.apply(t,[this].concat(e))||this).id=l().attribute("id"),n.mail_suffix=l().attribute("mail_suffix"),n.mail_host=l().attribute("mail_host"),n.mail_port=l().attribute("mail_port"),n.mail_username=l().attribute("mail_username"),n.mail_password=l().attribute("mail_password"),n.mail_encryption=l().attribute("mail_encryption"),n.mail_from=l().attribute("mail_from"),n}return i(n,t),n}(l());const u=[(new(e().Store)).add("multi-mailer",s)],c=flarum.core.compat["admin/app"];var d=t.n(c);const f=flarum.core.compat["admin/components/ExtensionPage"];var p=t.n(f);const h=flarum.core.compat["common/components/Button"];var b=t.n(h);const _=flarum.core.compat["common/components/Modal"];var v=t.n(_);const y=flarum.core.compat["common/utils/Stream"];var g=t.n(y),M=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var o=n.prototype;return o.oninit=function(n){var o=this;t.prototype.oninit.call(this,n),this.mailer=this.attrs.mailer,this.fields=["mail_suffix","mail_host","mail_port","mail_username","mail_password","mail_encryption","mail_from"],this.values=this.fields.reduce((function(t,n){return t[n]=g()(o.mailer[n]()||""),t}),{})},o.className=function(){return"MailerModal Modal--large"},o.title=function(){return"Edit"},o.content=function(){var t=this;return m("div",{className:"Modal-body"},m("form",{onsubmit:this.onsubmit.bind(this)},this.fields.map((function(n){return m("div",{className:"Form-group"},m("label",{className:"MailerModal-label"},d().translator.trans("core.admin.email."+n+"_label")),m("input",{className:"FormControl",bidi:t.values[n],placeholder:n,disabled:"mail_suffix"===n&&1===t.mailer.id()}))})),m("div",{className:"Form-group"},b().component({type:"submit",className:"Button Button--primary Button--block MailerModal-save",loading:this.loading},d().translator.trans("core.admin.settings.submit_button")))))},o.onsubmit=function(t){var n=this;t.preventDefault(),this.loading=!0;var o=this.fields.reduce((function(t,o){return t[o]=n.values[o](),t}),{});this.mailer.save(o).then((function(){n.loading=!1,m.redraw(),n.hide()}))},n}(v()),N=function(t){function n(){return t.apply(this,arguments)||this}i(n,t);var o=n.prototype;return o.oninit=function(n){var o=this;t.prototype.oninit.call(this,n),this.loading=!0,this.records=[],d().store.find("multi-mailer").then((function(t){o.records=t,o.loading=!1,m.redraw()}))},o.content=function(){var t=this;return m("div",{className:"container MultiMailer-container"},m("table",{className:"MailerSettingsPage-table"},m("thead",null,m("tr",null,m("th",null,"Mail Suffix"),m("th",null,"Mail Host"),m("th",null,"Mail Port"),m("th",null,"Mail Username"),m("th",null,"Action"))),m("tbody",null,this.records.map((function(n){return m("tr",null,m("td",null,n.mail_suffix()),m("td",null,n.mail_host()),m("td",null,n.mail_port()),m("td",null,n.mail_username()),m("td",null,m(b(),{className:"Button Button--icon",icon:"fas fa-edit",onclick:function(){d().modal.show(M,{mailer:n})}}),m(b(),{className:"Button Button--icon",icon:"fas fa-trash",disabled:1===t.records.length||t.loading||1===n.id(),onclick:function(){n.delete().then((function(){t.records=t.records.filter((function(t){return t!==n})),m.redraw()}))}})))})),m("tr",null,m("td",{colspan:"4"},m(b(),{className:"Button Button--block",onclick:function(){d().store.createRecord("multi-mailer").save({mail_suffix:"new.com",mail_port:465,mail_encryption:"ssl"}).then((function(n){t.records.push(n),d().modal.show(M,{mailer:n})}))}},m("i",{className:"fas fa-plus"})," Add"))))))},n}(p());d().initializers.add("foskym/flarum-multi-mailer",(function(){d().extensionData.for("foskym-multi-mailer").registerPage(N)}))})(),module.exports=n})();
//# sourceMappingURL=admin.js.map